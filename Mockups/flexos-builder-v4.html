<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlexOS Builder</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0F1419;
            --bg-secondary: #1A1F26;
            --bg-tertiary: #242B33;
            --bg-quaternary: #2D3440;
            
            --text-primary: #F7F9FA;
            --text-secondary: #D1D9E0;
            --text-tertiary: #8B949E;
            --text-muted: #6E7681;
            
            --border-primary: #30363D;
            --border-secondary: #3A4046;
            
            --primary-500: #16C181;
            --primary-400: #34D399;
            --primary-600: #10A574;
            
            --success: #2EA043;
            --warning: #DB6D28;
            --error: #F85149;
            --info: #58A6FF;
            
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-primary);
            padding: 0.75rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
            z-index: 100;
            position: relative;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--primary-500);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary-500), var(--primary-400));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: white;
        }

        .project-name {
            font-size: 1rem;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: 1px solid var(--border-primary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-500);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-600);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-primary);
        }

        .btn-secondary:hover {
            background: var(--bg-quaternary);
            color: var(--text-primary);
        }

        .btn-focus {
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            color: white;
            font-weight: 600;
        }

        .btn-focus:hover {
            background: linear-gradient(135deg, #7C3AED, #9333EA);
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(139, 92, 246, 0.3);
        }

        .btn-focus.exit {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-primary);
        }

        .btn-focus.exit:hover {
            background: var(--bg-quaternary);
            color: var(--text-primary);
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 40% 60%;
            height: calc(100vh - 60px);
            gap: 1px;
            background: var(--border-primary);
            position: relative;
        }

        /* Focus Mode Overlay */
        .focus-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .focus-overlay.active {
            display: flex;
        }

        .focus-header {
            padding: 1rem 2rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .focus-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .focus-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 1000px;
            margin: 0 auto;
            width: 100%;
            padding: 2rem;
        }

        /* Chat Panel */
        .chat-panel {
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
        }

        .chat-title {
            font-weight: 600;
            font-size: 0.875rem;
            flex: 1;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .focus-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 0;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .message {
            display: flex;
            gap: 0.75rem;
            max-width: 90%;
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .focus-overlay .message {
            max-width: 100%;
        }

        .focus-overlay .message.user {
            max-width: 80%;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-500);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--bg-quaternary);
        }

        .focus-overlay .message-avatar {
            width: 40px;
            height: 40px;
            font-size: 1rem;
        }

        .message-content {
            background: var(--bg-tertiary);
            padding: 0.75rem 1rem;
            border-radius: 12px;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .message.user .message-content {
            background: rgba(22, 193, 129, 0.1);
            border: 1px solid rgba(22, 193, 129, 0.2);
        }

        .focus-overlay .message-content {
            font-size: 1rem;
            padding: 1rem 1.25rem;
            line-height: 1.6;
        }

        /* Chat Input - Normal Mode */
        .chat-input-area {
            padding: 1rem;
            border-top: 1px solid var(--border-primary);
            background: var(--bg-secondary);
        }

        /* Chat Input - Focus Mode */
        .focus-chat-input {
            padding: 2rem 0 0;
            background: transparent;
        }

        /* Context Bar */
        .context-bar {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .context-item {
            background: var(--bg-quaternary);
            border: 1px solid var(--border-secondary);
            border-radius: 16px;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
        }

        .focus-overlay .context-item {
            font-size: 0.875rem;
            padding: 0.5rem 1rem;
        }

        .context-item .remove-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .context-item .remove-btn:hover {
            color: var(--error);
        }

        /* WhatsApp-style Input Container */
        .input-container {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 24px;
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            padding: 0.5rem;
            transition: border-color 0.2s ease;
            position: relative;
        }

        .input-container:focus-within {
            border-color: var(--primary-500);
        }

        .focus-overlay .input-container {
            border-radius: 32px;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-secondary);
        }

        .attach-btn {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            position: relative;
        }

        .attach-btn:hover {
            background: var(--bg-quaternary);
            color: var(--text-primary);
        }

        .focus-overlay .attach-btn {
            padding: 0.75rem;
        }

        .chat-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 0.875rem;
            resize: none;
            min-height: 20px;
            max-height: 120px;
            padding: 0.5rem 0;
            line-height: 1.4;
            font-family: inherit;
        }

        .chat-input:focus {
            outline: none;
        }

        .chat-input::placeholder {
            color: var(--text-muted);
        }

        .focus-overlay .chat-input {
            font-size: 1rem;
            padding: 0.75rem 0;
            max-height: 200px;
        }

        .send-btn {
            background: var(--primary-500);
            color: white;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            opacity: 0;
            transform: scale(0.8);
        }

        .send-btn.show {
            opacity: 1;
            transform: scale(1);
        }

        .send-btn:hover {
            background: var(--primary-600);
            transform: scale(1.05);
        }

        .focus-overlay .send-btn {
            width: 40px;
            height: 40px;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            bottom: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            min-width: 280px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .context-menu.show {
            display: block;
            animation: slideUp 0.2s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .context-menu-section {
            padding: 0.75rem 0;
        }

        .context-menu-title {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .context-menu-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }

        .context-menu-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .context-menu-divider {
            height: 1px;
            background: var(--border-primary);
            margin: 0.5rem 0;
        }

        .upload-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-secondary);
            border-radius: 12px;
            padding: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .upload-item .file-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        /* Content Panel */
        .content-panel {
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-nav {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-primary);
            padding: 0 1rem;
            display: flex;
            overflow-x: auto;
        }

        .tab-button {
            padding: 1rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-tertiary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab-button:hover {
            color: var(--text-secondary);
        }

        .tab-button.active {
            color: var(--primary-500);
            border-bottom-color: var(--primary-500);
        }

        .tab-content {
            display: none;
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
        }

        .tab-content.active {
            display: block;
        }

        /* Focus Welcome */
        .focus-welcome {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 4rem 2rem;
            flex: 1;
        }

        .focus-welcome h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #8B5CF6, #A855F7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .focus-welcome p {
            font-size: 1.125rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            max-width: 600px;
            line-height: 1.6;
        }

        .focus-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
            max-width: 600px;
        }

        .focus-feature {
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            text-align: left;
        }

        .focus-feature-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .focus-feature-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .focus-feature-desc {
            font-size: 0.875rem;
            color: var(--text-tertiary);
        }

        /* Grid Layouts */
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .content-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .filter-tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 0.25rem;
            gap: 0.25rem;
        }

        .filter-tab {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            background: transparent;
            color: var(--text-tertiary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .filter-tab.active {
            background: var(--primary-500);
            color: white;
        }

        .filter-tab:hover:not(.active) {
            background: var(--bg-quaternary);
            color: var(--text-secondary);
        }

        /* Pages Grid */
        .pages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .page-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .page-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary-500);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .page-preview {
            height: 160px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-quaternary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .page-preview::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200"><rect width="300" height="40" fill="%23444"/><rect x="20" y="60" width="260" height="20" fill="%23666"/><rect x="20" y="90" width="180" height="15" fill="%23555"/><rect x="20" y="120" width="120" height="60" fill="%23777"/><rect x="160" y="120" width="120" height="60" fill="%23777"/></svg>') center/cover;
            opacity: 0.4;
        }

        .page-info {
            padding: 1.25rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .page-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .page-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-done {
            background: rgba(46, 160, 67, 0.2);
            color: var(--success);
        }

        .status-in-progress {
            background: rgba(219, 109, 40, 0.2);
            color: var(--warning);
        }

        .status-planned {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .page-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.4;
            margin-bottom: 1rem;
        }

        .page-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Features List */
        .features-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .feature-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary-500);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .feature-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .feature-title-section {
            flex: 1;
        }

        .feature-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .feature-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .feature-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-500);
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Journeys List */
        .journeys-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .journey-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .journey-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary-500);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .journey-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .journey-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .journey-flow {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .journey-step {
            padding: 0.375rem 0.75rem;
            background: var(--bg-tertiary);
            border-radius: 16px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .journey-arrow {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .journey-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .journey-stat {
            text-align: center;
        }

        .journey-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-400);
        }

        .journey-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Dashboard */
        .dashboard-welcome {
            text-align: center;
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary-300) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dashboard-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .project-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-500), var(--primary-400));
        }

        .project-card:hover {
            transform: translateY(-6px);
            border-color: var(--primary-500);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .project-card h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .project-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .project-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .project-progress {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .progress-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: conic-gradient(var(--primary-500) 0deg, var(--primary-500) 252deg, var(--bg-tertiary) 252deg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .new-project-card {
            border: 2px dashed var(--border-secondary);
            background: transparent;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        .new-project-card:hover {
            border-color: var(--primary-500);
            background: rgba(22, 193, 129, 0.05);
        }

        .new-project-card::before {
            display: none;
        }

        /* Icons */
        .icon {
            width: 16px;
            height: 16px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .file-input {
            display: none;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 35% 65%;
            }
        }

        @media (max-width: 968px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .content-panel {
                display: none;
            }
        }

        /* Escape hint */
        .escape-hint {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            color: var(--text-tertiary);
            opacity: 0;
            animation: fadeInOut 4s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            20%, 80% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo" style="cursor: pointer;" onclick="goToLandingPage()">
            <div class="logo-icon">F</div>
            FlexOS Builder
        </div>
        
        <div class="project-name">E-commerce Store</div>
        
        <div class="header-actions">
            <button class="btn btn-secondary" onclick="showDashboard()">
                <svg class="icon" viewBox="0 0 24 24">
                    <rect width="7" height="9" x="3" y="3" rx="1"></rect>
                    <rect width="7" height="5" x="14" y="3" rx="1"></rect>
                    <rect width="7" height="9" x="14" y="12" rx="1"></rect>
                    <rect width="7" height="5" x="3" y="16" rx="1"></rect>
                </svg>
                Dashboard
            </button>
            
            <button class="btn btn-focus" onclick="toggleFocusMode()" id="focusBtn">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                    <circle cx="12" cy="12" r="3"/>
                </svg>
                Focus Chat
            </button>
            
            <button class="btn btn-secondary">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7,10 12,15 17,10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Export
            </button>
            
            <button class="btn btn-primary">
                <svg class="icon" viewBox="0 0 24 24">
                    <polygon points="12,2 22,8.5 22,15.5 12,22 2,15.5 2,8.5"/>
                </svg>
                Build
            </button>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout" id="mainLayout">
        <!-- Chat Panel -->
        <div class="chat-panel">
            <div class="chat-header">
                <h3 class="chat-title">AI Assistant</h3>
                <button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">
                    Clear
                </button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        Hi! I'm here to help you build your e-commerce store. I can see you're working on the overall project vision. What specific aspect would you like to explore or improve?
                    </div>
                </div>
            </div>
            
            <div class="chat-input-area">
                <!-- Context Bar -->
                <div class="context-bar" id="contextBar" style="display: none;"></div>
                
                <!-- WhatsApp-style Input -->
                <div class="input-container">
                    <button class="attach-btn" onclick="toggleContextMenu()" title="Add context or files">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                    </button>
                    
                    <textarea 
                        class="chat-input" 
                        placeholder="Discuss your project at a high level..." 
                        onkeydown="handleChatInput(event)" 
                        oninput="handleInputChange()"
                        id="chatInput"
                        rows="1"
                    ></textarea>
                    
                    <button class="send-btn" onclick="sendMessage()" id="sendBtn">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M22 2L11 13M22 2L15 22L11 13L2 9L22 2Z"/>
                        </svg>
                    </button>
                    
                    <!-- Context Menu -->
                    <div class="context-menu" id="contextMenu">
                        <div class="context-menu-section">
                            <div class="context-menu-title">Upload Files</div>
                            <div class="context-menu-item" onclick="uploadFiles()">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14,2 14,8 20,8"/>
                                </svg>
                                Screenshots & Documents
                            </div>
                        </div>
                        
                        <div class="context-menu-divider"></div>
                        
                        <div class="context-menu-section">
                            <div class="context-menu-title">Project Elements</div>
                            <div class="context-menu-item" onclick="addContext('feature', 'User Authentication')">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M9 12l2 2 4-4"/>
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                User Authentication
                            </div>
                            <div class="context-menu-item" onclick="addContext('feature', 'Product Catalog')">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M9 12l2 2 4-4"/>
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                Product Catalog
                            </div>
                            <div class="context-menu-item" onclick="addContext('page', 'Homepage')">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <rect width="7" height="9" x="3" y="3" rx="1"/>
                                    <rect width="7" height="5" x="14" y="3" rx="1"/>
                                </svg>
                                Homepage Design
                            </div>
                            <div class="context-menu-item" onclick="addContext('page', 'Checkout')">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <rect width="7" height="9" x="3" y="3" rx="1"/>
                                    <rect width="7" height="5" x="14" y="3" rx="1"/>
                                </svg>
                                Checkout Flow
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Panel -->
        <div class="content-panel" id="contentPanel">
            <nav class="tab-nav">
                <button class="tab-button active" onclick="switchTab('vision')">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Vision
                </button>
                <button class="tab-button" onclick="switchTab('pages')">
                    <svg class="icon" viewBox="0 0 24 24">
                        <rect width="7" height="9" x="3" y="3" rx="1"></rect>
                        <rect width="7" height="5" x="14" y="3" rx="1"></rect>
                    </svg>
                    Design Pages
                </button>
                <button class="tab-button" onclick="switchTab('features')">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M9 12l2 2 4-4"></path>
                        <circle cx="12" cy="12" r="10"></circle>
                    </svg>
                    Features
                </button>
                <button class="tab-button" onclick="switchTab('journeys')">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z"></path>
                    </svg>
                    Journeys
                </button>
                <button class="tab-button" onclick="switchTab('database')">
                    <svg class="icon" viewBox="0 0 24 24">
                        <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                        <path d="M3 5v14a9 3 0 0 0 18 0V5"></path>
                    </svg>
                    Database
                </button>
            </nav>

            <!-- Vision Tab -->
            <div class="tab-content active" id="vision-tab">
                <div class="content-header">
                    <h2 class="content-title">Project Vision</h2>
                </div>
                
                <div style="background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
                    <h3 style="color: var(--primary-500); margin-bottom: 1rem;">E-commerce Store</h3>
                    <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: 1.5rem;">
                        A modern, responsive e-commerce platform that provides seamless shopping experiences across all devices. 
                        Focus on user-friendly navigation, secure payments, and efficient order management for small to medium retailers.
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-400);">85%</div>
                            <div style="font-size: 0.875rem; color: var(--text-tertiary);">Target Conversion</div>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-400);">&lt;2s</div>
                            <div style="font-size: 0.875rem; color: var(--text-tertiary);">Page Load Time</div>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-400);">4.5+</div>
                            <div style="font-size: 0.875rem; color: var(--text-tertiary);">Customer Rating</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Design Pages Tab -->
            <div class="tab-content" id="pages-tab">
                <div class="content-header">
                    <h2 class="content-title">Design Pages</h2>
                    <div class="filter-tabs">
                        <button class="filter-tab active" onclick="filterPages('all')">All</button>
                        <button class="filter-tab" onclick="filterPages('done')">Done</button>
                        <button class="filter-tab" onclick="filterPages('in-progress')">In Progress</button>
                        <button class="filter-tab" onclick="filterPages('planned')">Planned</button>
                    </div>
                </div>
                
                <div class="pages-grid" id="pagesGrid">
                    <div class="page-card" data-status="done" onclick="openPageDetail('homepage')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">Homepage</h4>
                                <span class="page-status status-done">Done</span>
                            </div>
                            <p class="page-description">Hero section, featured products, testimonials, newsletter signup</p>
                            <div class="page-meta">
                                <span>Updated 2h ago</span>
                                <span>Ready for review</span>
                            </div>
                        </div>
                    </div>

                    <div class="page-card" data-status="in-progress" onclick="openPageDetail('products')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">Product Listing</h4>
                                <span class="page-status status-in-progress">In Progress</span>
                            </div>
                            <p class="page-description">Grid/list view, filters, search, sorting, pagination</p>
                            <div class="page-meta">
                                <span>Updated 1d ago</span>
                                <span>75% complete</span>
                            </div>
                        </div>
                    </div>

                    <div class="page-card" data-status="done" onclick="openPageDetail('product-detail')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">Product Detail</h4>
                                <span class="page-status status-done">Done</span>
                            </div>
                            <p class="page-description">Image gallery, specs, reviews, add to cart, related products</p>
                            <div class="page-meta">
                                <span>Updated 3h ago</span>
                                <span>Review approved</span>
                            </div>
                        </div>
                    </div>

                    <div class="page-card" data-status="planned" onclick="openPageDetail('cart')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">Shopping Cart</h4>
                                <span class="page-status status-planned">Planned</span>
                            </div>
                            <p class="page-description">Item management, quantity updates, price totals, promo codes</p>
                            <div class="page-meta">
                                <span>Created 5h ago</span>
                                <span>Spec ready</span>
                            </div>
                        </div>
                    </div>

                    <div class="page-card" data-status="planned" onclick="openPageDetail('checkout')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">Checkout</h4>
                                <span class="page-status status-planned">Planned</span>
                            </div>
                            <p class="page-description">Payment forms, shipping options, order review, confirmation</p>
                            <div class="page-meta">
                                <span>Created 6h ago</span>
                                <span>Awaiting design</span>
                            </div>
                        </div>
                    </div>

                    <div class="page-card" data-status="in-progress" onclick="openPageDetail('account')">
                        <div class="page-preview"></div>
                        <div class="page-info">
                            <div class="page-header">
                                <h4 class="page-title">User Account</h4>
                                <span class="page-status status-in-progress">In Progress</span>
                            </div>
                            <p class="page-description">Profile settings, order history, addresses, preferences</p>
                            <div class="page-meta">
                                <span>Updated 2d ago</span>
                                <span>50% complete</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Features Tab -->
            <div class="tab-content" id="features-tab">
                <div class="content-header">
                    <h2 class="content-title">Features</h2>
                    <div class="filter-tabs">
                        <button class="filter-tab active" onclick="filterFeatures('all')">All</button>
                        <button class="filter-tab" onclick="filterFeatures('done')">Done</button>
                        <button class="filter-tab" onclick="filterFeatures('in-progress')">In Progress</button>
                        <button class="filter-tab" onclick="filterFeatures('planned')">Planned</button>
                    </div>
                </div>
                
                <div class="features-list" id="featuresList">
                    <div class="feature-card" data-status="in-progress" onclick="openFeatureDetail('auth')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">User Authentication</h4>
                                <p class="feature-description">Secure login, registration, password reset, social login options (Google, Apple), two-factor authentication</p>
                            </div>
                            <span class="feature-status status-in-progress">In Progress</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%"></div>
                            </div>
                            <span class="progress-text">75% Complete</span>
                        </div>
                    </div>

                    <div class="feature-card" data-status="in-progress" onclick="openFeatureDetail('catalog')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">Product Catalog</h4>
                                <p class="feature-description">Categories, search functionality, advanced filters, inventory management, product variations</p>
                            </div>
                            <span class="feature-status status-in-progress">In Progress</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%"></div>
                            </div>
                            <span class="progress-text">60% Complete</span>
                        </div>
                    </div>

                    <div class="feature-card" data-status="planned" onclick="openFeatureDetail('cart')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">Shopping Cart</h4>
                                <p class="feature-description">Add/remove items, quantity updates, persistent cart, guest checkout, promo codes</p>
                            </div>
                            <span class="feature-status status-planned">Planned</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 25%"></div>
                            </div>
                            <span class="progress-text">25% Complete</span>
                        </div>
                    </div>

                    <div class="feature-card" data-status="planned" onclick="openFeatureDetail('payment')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">Payment Processing</h4>
                                <p class="feature-description">Stripe integration, multiple payment methods, secure checkout, order confirmation</p>
                            </div>
                            <span class="feature-status status-planned">Planned</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 10%"></div>
                            </div>
                            <span class="progress-text">10% Complete</span>
                        </div>
                    </div>

                    <div class="feature-card" data-status="done" onclick="openFeatureDetail('responsive')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">Responsive Design</h4>
                                <p class="feature-description">Mobile-first approach, tablet optimization, desktop enhancements, progressive web app features</p>
                            </div>
                            <span class="feature-status status-done">Done</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 100%"></div>
                            </div>
                            <span class="progress-text">100% Complete</span>
                        </div>
                    </div>

                    <div class="feature-card" data-status="planned" onclick="openFeatureDetail('reviews')">
                        <div class="feature-header">
                            <div class="feature-title-section">
                                <h4 class="feature-title">Product Reviews</h4>
                                <p class="feature-description">Star ratings, written reviews, photo uploads, review moderation, helpful votes</p>
                            </div>
                            <span class="feature-status status-planned">Planned</span>
                        </div>
                        <div class="feature-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 0%"></div>
                            </div>
                            <span class="progress-text">Not Started</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Journeys Tab -->
            <div class="tab-content" id="journeys-tab">
                <div class="content-header">
                    <h2 class="content-title">User Journeys</h2>
                    <div class="filter-tabs">
                        <button class="filter-tab active" onclick="filterJourneys('all')">All</button>
                        <button class="filter-tab" onclick="filterJourneys('done')">Done</button>
                        <button class="filter-tab" onclick="filterJourneys('in-progress')">In Progress</button>
                        <button class="filter-tab" onclick="filterJourneys('planned')">Planned</button>
                    </div>
                </div>
                
                <div class="journeys-list" id="journeysList">
                    <div class="journey-card" data-status="done" onclick="openJourneyDetail('purchase')">
                        <div class="journey-header">
                            <h4 class="journey-title">Purchase Journey</h4>
                            <span class="feature-status status-done">Done</span>
                        </div>
                        <div class="journey-flow">
                            <span class="journey-step">Browse</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Product</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Cart</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Checkout</span>
                        </div>
                        <div class="journey-stats">
                            <div class="journey-stat">
                                <div class="journey-stat-value">4</div>
                                <div class="journey-stat-label">Steps</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">85%</div>
                                <div class="journey-stat-label">Conversion</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">3.2m</div>
                                <div class="journey-stat-label">Avg Time</div>
                            </div>
                        </div>
                    </div>

                    <div class="journey-card" data-status="in-progress" onclick="openJourneyDetail('onboarding')">
                        <div class="journey-header">
                            <h4 class="journey-title">User Onboarding</h4>
                            <span class="feature-status status-in-progress">In Progress</span>
                        </div>
                        <div class="journey-flow">
                            <span class="journey-step">Landing</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Sign Up</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Profile</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">First Order</span>
                        </div>
                        <div class="journey-stats">
                            <div class="journey-stat">
                                <div class="journey-stat-value">4</div>
                                <div class="journey-stat-label">Steps</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">67%</div>
                                <div class="journey-stat-label">Completion</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">5.7m</div>
                                <div class="journey-stat-label">Avg Time</div>
                            </div>
                        </div>
                    </div>

                    <div class="journey-card" data-status="planned" onclick="openJourneyDetail('return')">
                        <div class="journey-header">
                            <h4 class="journey-title">Return Process</h4>
                            <span class="feature-status status-planned">Planned</span>
                        </div>
                        <div class="journey-flow">
                            <span class="journey-step">Request</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Approval</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Ship</span>
                            <span class="journey-arrow">→</span>
                            <span class="journey-step">Refund</span>
                        </div>
                        <div class="journey-stats">
                            <div class="journey-stat">
                                <div class="journey-stat-value">4</div>
                                <div class="journey-stat-label">Steps</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">--</div>
                                <div class="journey-stat-label">Rate</div>
                            </div>
                            <div class="journey-stat">
                                <div class="journey-stat-value">--</div>
                                <div class="journey-stat-label">Time</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Database Tab -->
            <div class="tab-content" id="database-tab">
                <div class="content-header">
                    <h2 class="content-title">Database Schema</h2>
                </div>
                <div style="background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: 12px; padding: 3rem; text-align: center; color: var(--text-tertiary);">
                    <svg style="width: 48px; height: 48px; margin-bottom: 1rem; opacity: 0.5;" viewBox="0 0 24 24" stroke="currentColor" fill="none">
                        <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                        <path d="M3 5v14a9 3 0 0 0 18 0V5"></path>
                        <path d="M3 12a9 3 0 0 0 18 0"></path>
                    </svg>
                    <p style="font-size: 1.125rem; margin-bottom: 0.5rem;">Database Schema Designer</p>
                    <p style="font-size: 0.875rem;">Interactive schema visualization and relationship mapping coming soon</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Overlay -->
    <div class="focus-overlay" id="dashboardOverlay" style="background: var(--bg-primary);">
        <div class="focus-header">
            <h1 class="focus-title">
                <svg class="icon" viewBox="0 0 24 24" style="width: 24px; height: 24px;">
                    <rect width="7" height="9" x="3" y="3" rx="1"></rect>
                    <rect width="7" height="5" x="14" y="3" rx="1"></rect>
                    <rect width="7" height="9" x="14" y="12" rx="1"></rect>
                    <rect width="7" height="5" x="3" y="16" rx="1"></rect>
                </svg>
                FlexOS Dashboard
            </h1>
            <button class="btn btn-focus exit" onclick="hideDashboard()">
                <svg class="icon" viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
                Back to Project
            </button>
            <button class="btn btn-secondary" onclick="goToLandingPage()" style="margin-left: 0.75rem;">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <path d="M9 22V12h6v10"/>
                </svg>
                Home
            </button>
        </div>
        
        <div class="dashboard-welcome">
            <h1 class="dashboard-title">FlexOS</h1>
            <p class="dashboard-subtitle">
                Build small ideas quickly. Plan big ideas properly. Load an existing project or start something new.
            </p>
            
            <div class="projects-grid">
                <div class="project-card" onclick="loadProject('ecommerce')">
                    <h3>E-commerce Store</h3>
                    <p>Modern shopping experience with cart, checkout, and user accounts</p>
                    <div class="project-meta">
                        <span>6 pages • 12 features</span>
                        <span>Updated 2h ago</span>
                    </div>
                    <div class="project-progress">
                        <div class="progress-circle">70%</div>
                        <span style="color: var(--text-secondary);">In active development</span>
                    </div>
                </div>
                
                <div class="project-card" onclick="loadProject('saas')">
                    <h3>SaaS Dashboard</h3>
                    <p>Analytics dashboard with charts, user management, and billing</p>
                    <div class="project-meta">
                        <span>8 pages • 15 features</span>
                        <span>Updated 1d ago</span>
                    </div>
                    <div class="project-progress">
                        <div class="progress-circle">45%</div>
                        <span style="color: var(--text-secondary);">Planning phase</span>
                    </div>
                </div>
                
                <div class="project-card" onclick="loadProject('blog')">
                    <h3>Blog Platform</h3>
                    <p>Content management system with rich editor and SEO optimization</p>
                    <div class="project-meta">
                        <span>4 pages • 8 features</span>
                        <span>Updated 3d ago</span>
                    </div>
                    <div class="project-progress">
                        <div class="progress-circle">90%</div>
                        <span style="color: var(--text-secondary);">Nearly complete</span>
                    </div>
                </div>
                
                <div class="project-card new-project-card" onclick="createNewProject()">
                    <svg style="width: 48px; height: 48px; margin-bottom: 1rem; color: var(--text-muted);" viewBox="0 0 24 24" stroke="currentColor" fill="none">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                    <h3 style="color: var(--text-secondary);">Start New Project</h3>
                    <p style="margin: 0; color: var(--text-tertiary);">Begin with a blank canvas or use a template</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Focus Mode Overlay -->
    <div class="focus-overlay" id="focusOverlay">
        <div class="focus-header">
            <h1 class="focus-title">
                🧙 Focus Chat Mode
            </h1>
            <button class="btn btn-focus exit" onclick="exitFocusMode()">
                <svg class="icon" viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
                Exit Focus
            </button>
        </div>
        
        <div class="focus-content">
            <!-- Welcome Screen -->
            <div class="focus-welcome" id="focusWelcome">
                <h1>🧙 Focus Chat Mode</h1>
                <p>
                    High-level project discussion without distractions. I'll ask thoughtful questions 
                    to help you fully explore your ideas, then update your project specifications 
                    based on our conversation.
                </p>
                
                <div class="focus-features">
                    <div class="focus-feature">
                        <div class="focus-feature-icon">💭</div>
                        <div class="focus-feature-title">Think Big Picture</div>
                        <div class="focus-feature-desc">No technical details yet</div>
                    </div>
                    <div class="focus-feature">
                        <div class="focus-feature-icon">🎯</div>
                        <div class="focus-feature-title">One Question at a Time</div>
                        <div class="focus-feature-desc">I'll guide the conversation</div>
                    </div>
                    <div class="focus-feature">
                        <div class="focus-feature-icon">📝</div>
                        <div class="focus-feature-title">I'll Document Everything</div>
                        <div class="focus-feature-desc">Focus on your vision</div>
                    </div>
                </div>
            </div>
            
            <!-- Chat Messages -->
            <div class="focus-chat-messages" id="focusChatMessages" style="display: none;">
            </div>
            
            <!-- Chat Input -->
            <div class="focus-chat-input" id="focusChatInput" style="display: none;">
                <!-- Context Bar -->
                <div class="context-bar" id="focusContextBar" style="display: none;"></div>
                
                <!-- WhatsApp-style Input -->
                <div class="input-container">
                    <button class="attach-btn" onclick="toggleFocusContextMenu()" title="Add context">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                    </button>
                    
                    <textarea 
                        class="chat-input" 
                        placeholder="Share your thoughts..." 
                        onkeydown="handleFocusChatInput(event)" 
                        oninput="handleFocusInputChange()"
                        id="focusChatInputField"
                        rows="1"
                    ></textarea>
                    
                    <button class="send-btn" onclick="sendFocusMessage()" id="focusSendBtn">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M22 2L11 13M22 2L15 22L11 13L2 9L22 2Z"/>
                        </svg>
                    </button>
                    
                    <!-- Focus Context Menu -->
                    <div class="context-menu" id="focusContextMenu">
                        <div class="context-menu-section">
                            <div class="context-menu-title">Upload Files</div>
                            <div class="context-menu-item" onclick="uploadFocusFiles()">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14,2 14,8 20,8"/>
                                </svg>
                                Screenshots & Documents
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Escape Hint -->
    <div class="escape-hint" id="escapeHint">
        Press ESC or click Exit Focus to return
    </div>

    <!-- Hidden File Input -->
    <input type="file" class="file-input" id="fileInput" multiple accept="image/*,.pdf,.doc,.docx,.txt">

    <script>
        let focusMode = false;
        let wizardStep = 0;
        let currentContext = [];
        let uploadedFiles = [];
        
        // Auto-resize textarea
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';
        }
        
        // Input change handlers
        function handleInputChange() {
            const input = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');
            autoResize(input);
            
            if (input.value.trim() || currentContext.length > 0) {
                sendBtn.classList.add('show');
            } else {
                sendBtn.classList.remove('show');
            }
        }
        
        function handleFocusInputChange() {
            const input = document.getElementById('focusChatInputField');
            const sendBtn = document.getElementById('focusSendBtn');
            autoResize(input);
            
            if (input.value.trim() || currentContext.length > 0) {
                sendBtn.classList.add('show');
            } else {
                sendBtn.classList.remove('show');
            }
        }
        
        // Keyboard handlers
        function handleChatInput(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        function handleFocusChatInput(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendFocusMessage();
            }
        }
        
        // Global keyboard handler
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && focusMode) {
                exitFocusMode();
            }
        });
        
        // Context Management
        function toggleContextMenu() {
            const menu = document.getElementById('contextMenu');
            menu.classList.toggle('show');
            closeMenuOnClickOutside(menu, '.attach-btn');
        }
        
        function toggleFocusContextMenu() {
            const menu = document.getElementById('focusContextMenu');
            menu.classList.toggle('show');
            closeMenuOnClickOutside(menu, '.attach-btn');
        }
        
        function closeMenuOnClickOutside(menu, triggerSelector) {
            setTimeout(() => {
                document.addEventListener('click', function closeMenu(e) {
                    if (!menu.contains(e.target) && !e.target.closest(triggerSelector)) {
                        menu.classList.remove('show');
                        document.removeEventListener('click', closeMenu);
                    }
                });
            }, 100);
        }
        
        function addContext(type, name) {
            const contextId = `${type}-${name.toLowerCase().replace(/\s+/g, '-')}`;
            
            if (currentContext.find(c => c.id === contextId)) return;
            
            currentContext.push({ id: contextId, type, name });
            updateContextBars();
            
            document.getElementById('contextMenu').classList.remove('show');
            document.getElementById('focusContextMenu').classList.remove('show');
            
            const message = `Added ${type}: ${name} to conversation context.`;
            if (focusMode) {
                addFocusMessage(message, false);
            } else {
                addMessage(message, false);
            }
        }
        
        function removeContext(contextId) {
            currentContext = currentContext.filter(c => c.id !== contextId);
            updateContextBars();
        }
        
        function updateContextBars() {
            updateContextBar('contextBar');
            updateContextBar('focusContextBar');
        }
        
        function updateContextBar(barId) {
            const contextBar = document.getElementById(barId);
            
            if (currentContext.length === 0 && uploadedFiles.length === 0) {
                contextBar.style.display = 'none';
                return;
            }
            
            contextBar.style.display = 'flex';
            contextBar.innerHTML = '';
            
            [...currentContext, ...uploadedFiles.map(f => ({ id: f.name, type: 'file', name: f.name }))].forEach(item => {
                const contextItem = document.createElement('div');
                contextItem.className = 'context-item';
                contextItem.innerHTML = `
                    <svg class="icon" viewBox="0 0 24 24">
                        ${getContextIcon(item.type)}
                    </svg>
                    ${item.name}
                    <button class="remove-btn" onclick="removeContext('${item.id}')" title="Remove">
                        <svg class="icon" viewBox="0 0 24 24" style="width: 10px; height: 10px;">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                `;
                contextBar.appendChild(contextItem);
            });
        }
        
        function getContextIcon(type) {
            const icons = {
                feature: '<path d="M9 12l2 2 4-4"/><circle cx="12" cy="12" r="10"/>',
                page: '<rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/>',
                document: '<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/>',
                file: '<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/>'
            };
            return icons[type] || '<circle cx="12" cy="12" r="10"/>';
        }
        
        // File Upload
        function uploadFiles() {
            document.getElementById('fileInput').click();
            document.getElementById('contextMenu').classList.remove('show');
        }
        
        function uploadFocusFiles() {
            document.getElementById('fileInput').click();
            document.getElementById('focusContextMenu').classList.remove('show');
        }
        
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const files = Array.from(event.target.files);
            
            files.forEach(file => {
                if (file.size > 10 * 1024 * 1024) {
                    const message = `File "${file.name}" is too large. Maximum size is 10MB.`;
                    if (focusMode) {
                        addFocusMessage(message, false);
                    } else {
                        addMessage(message, false);
                    }
                    return;
                }
                uploadedFiles.push(file);
            });
            
            updateContextBars();
            
            if (files.length > 0) {
                const message = `Uploaded ${files.length} file(s). I'll analyze them when you send your message.`;
                if (focusMode) {
                    addFocusMessage(message, false);
                } else {
                    addMessage(message, false);
                }
            }
            
            event.target.value = '';
        });
        
        // Message Functions
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message && currentContext.length === 0 && uploadedFiles.length === 0) return;
            
            addMessage(message || '(Shared context)', true);
            input.value = '';
            input.style.height = 'auto';
            document.getElementById('sendBtn').classList.remove('show');
            
            clearContext();
            
            setTimeout(() => {
                addMessage("That's a great point! Let me help you refine that aspect of your project.", false);
            }, 1000);
        }
        
        function sendFocusMessage() {
            const input = document.getElementById('focusChatInputField');
            const message = input.value.trim();
            
            if (!message && currentContext.length === 0 && uploadedFiles.length === 0) return;
            
            addFocusMessage(message || '(Shared context)', true);
            input.value = '';
            input.style.height = 'auto';
            document.getElementById('focusSendBtn').classList.remove('show');
            
            clearContext();
            
            setTimeout(() => {
                handleWizardResponse(message);
            }, 1000);
        }
        
        function clearContext() {
            currentContext = [];
            uploadedFiles = [];
            updateContextBars();
        }
        
        function addMessage(text, isUser) {
            const container = document.getElementById('chatMessages');
            addMessageToContainer(container, text, isUser);
        }
        
        function addFocusMessage(text, isUser) {
            const container = document.getElementById('focusChatMessages');
            addMessageToContainer(container, text, isUser);
        }
        
        function addMessageToContainer(container, text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : ''}`;
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${isUser ? 'U' : 'AI'}</div>
                <div class="message-content">${text}</div>
            `;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }
        
        // Focus Mode
        function toggleFocusMode() {
            if (focusMode) {
                exitFocusMode();
            } else {
                enterFocusMode();
            }
        }
        
        function enterFocusMode() {
            focusMode = true;
            document.getElementById('focusOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Show escape hint
            const hint = document.getElementById('escapeHint');
            hint.style.display = 'block';
            setTimeout(() => hint.style.display = 'none', 4000);
            
            // Start wizard
            setTimeout(() => {
                document.getElementById('focusWelcome').style.display = 'none';
                document.getElementById('focusChatMessages').style.display = 'flex';
                document.getElementById('focusChatInput').style.display = 'block';
                
                addFocusMessage("Hi! I'm here to help you explore your e-commerce project at a high level. What's the biggest challenge you're trying to solve for your customers?", false);
            }, 1000);
        }
        
        function exitFocusMode() {
            focusMode = false;
            document.getElementById('focusOverlay').classList.remove('active');
            document.body.style.overflow = '';
            
            // Reset focus mode state
            setTimeout(() => {
                document.getElementById('focusWelcome').style.display = 'flex';
                document.getElementById('focusChatMessages').style.display = 'none';
                document.getElementById('focusChatInput').style.display = 'none';
                document.getElementById('focusChatMessages').innerHTML = '';
                wizardStep = 0;
            }, 300);
        }
        
        function handleWizardResponse(userMessage) {
            wizardStep++;
            
            const questions = [
                "That's a great insight! Who specifically is struggling with this problem? Paint me a picture of your ideal customer.",
                "Perfect! Now I'm getting a clear picture. When this person uses your solution, what's the very first thing they should be able to do?",
                "Excellent! What would make them choose your solution over just going to Amazon or another big retailer?",
                "I love that angle! If you had to pick just three features that absolutely MUST work perfectly from day one, what would they be?",
                "This is really coming together! Based on everything you've shared, I can see this is much more than just another online store. Let me update your project vision to reflect these insights..."
            ];
            
            if (wizardStep < questions.length) {
                setTimeout(() => {
                    addFocusMessage(questions[wizardStep], false);
                }, 500);
            } else {
                setTimeout(() => {
                    addFocusMessage("Perfect! I've captured all your insights. I'm now updating your project specifications with these discoveries. You can see the changes in your Vision and Features tabs.", false);
                    setTimeout(exitFocusMode, 3000);
                }, 500);
            }
        }
        
        // Tab Management
        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }
        
        // Navigation Functions
        function showDashboard() {
            document.getElementById('dashboardOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function hideDashboard() {
            document.getElementById('dashboardOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        function loadProject(projectType) {
            hideDashboard();
            // Could load different project states based on type
        }
        
        function createNewProject() {
            hideDashboard();
            // Reset to new project state
        }
        
        function openPageDetail(pageName) {
            // Navigate to detail view
            console.log('Opening page detail:', pageName);
        }
        
        function openFeatureDetail(featureName) {
            // Navigate to feature detail
            console.log('Opening feature detail:', featureName);
        }
        
        function openJourneyDetail(journeyName) {
            // Navigate to journey detail
            console.log('Opening journey detail:', journeyName);
        }
        
        function filterPages(filter) {
            const pages = document.querySelectorAll('.page-card');
            const filterButtons = document.querySelectorAll('.filter-tab');
            
            filterButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            pages.forEach(page => {
                if (filter === 'all' || page.dataset.status === filter) {
                    page.style.display = 'block';
                } else {
                    page.style.display = 'none';
                }
            });
        }
        
        function filterFeatures(filter) {
            const features = document.querySelectorAll('.feature-card');
            const filterButtons = document.querySelectorAll('.filter-tab');
            
            filterButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            features.forEach(feature => {
                if (filter === 'all' || feature.dataset.status === filter) {
                    feature.style.display = 'block';
                } else {
                    feature.style.display = 'none';
                }
            });
        }
        
        function filterJourneys(filter) {
            const journeys = document.querySelectorAll('.journey-card');
            const filterButtons = document.querySelectorAll('.filter-tab');
            
            filterButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            journeys.forEach(journey => {
                if (filter === 'all' || journey.dataset.status === filter) {
                    journey.style.display = 'block';
                } else {
                    journey.style.display = 'none';
                }
            });
        }
        
        // Add navigation to go back to landing page
        function goToLandingPage() {
            window.location.href = 'index.html';
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initial message
            setTimeout(() => {
                addMessage("Hi! I'm here to help you build your e-commerce store. I can see you're working on the overall project vision. What specific aspect would you like to explore or improve?", false);
            }, 500);
        });
    </script>
</body>
</html>